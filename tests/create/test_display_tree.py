from biohansel.create.display_tree import display_tree


def test_get_sequences():
    test_dict = {'SRR6683541': '1', 'SRR6683736': '1', 'SRR6967786': '1', 'SRR6683914': '1', 'SRR6683916': '1',
                 'SRR7130351': '2.1.1.1', 'SRR7170730': '2.1.1.1', 'SRR7128414': '2.1.1.2', 'SRR7167142': '2.1.1.2',
                 'SRR7128411': '2.1.1.2', 'SRR7130348': '2.1.1.2', 'SRR7130522': '2.1.1.2', 'SRR7130347': '2.1.2',
                 'SRR7168670': '2.1.2', 'SRR7221720': '2.1.2', 'Reference': '2.1.2', 'SRR6703297': '2.1',
                 'SRR7168116': '2.1', 'SRR6683917': '2.2', 'SRR7135200': '2.2'}
    expected_result = ("((SRR7128414-2.1.1.2:0.0,SRR7167142-2.1.1.2:0.0):0.00055,(SRR7128411-2.1.1.2:0.00055,(SRR713034"
                       "8-2.1.1.2:0.00055,SRR7130522-2.1.1.2:0.00055)0.738:0.00055)0.900:0.00055,(SRR7130351-2.1.1.1:0."
                       "00055,(((SRR6703297-2.1:0.00187,(SRR7168116-2.1:0.00195,((SRR6683916-1:0.30656,(SRR6683914-1:"
                       "0.00390,(SRR6967786-1:0.00063,(SRR6683541-1:0.00061,SRR6683736-1:0.00062)0.921:0.00055)1.000"
                       ":0.00464)1.000:0.28034)1.000:0.54172,(SRR6683917-2.2:0.15347,SRR7135200-2.2:0.14185)1.000:"
                       "0.15502)1.000:0.40486)1.000:0.00055)1.000:0.00121,(Reference-2.1.2:0.00055,(SRR7221720-2.1"
                       ".2:0.00055,(SRR7130347-2.1.2:0.00055,SRR7168670-2.1.2:0.00055)0.998:0.00055)1.000:0.00055"
                       ")1.000:0.00055)1.000:0.00055,SRR7170730-2.1.1.1:0.00055)0.404:0.00055)0.912:0.00055);\n")

    test_result = display_tree("tests/data/create/e-coliO157-tree_file.tree", test_dict)
    assert (expected_result == test_result)
